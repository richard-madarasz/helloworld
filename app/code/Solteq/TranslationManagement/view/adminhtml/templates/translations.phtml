<?php

/**
 * @var \Solteq\TranslationManagement\Block\Index $block
 */
$languageFiles = $block->findLanguageFiles();
?>
<html>
<head>
    <script src="jquery.tabledit.min.js"></script>
</head>

<style>
    table {  font-family: arial, sans-serif;  border-collapse: collapse;  width: 40%;  margin-top: 30px;}
    td, th {  border: 1px solid #dddddd;  text-align: left;  padding: 8px;  }
    tr:nth-child(even) { background-color: #dddddd; }
    .post-name{width:30%}
    .post-edit{width:10%}
    .csv-field{border: none; width: 100%; background: none;}

</style>
<body>


    <?php

    if (isset($_GET['file'])) {
        echo $_GET['file']. "<br />\n";
        if (($langFile = fopen($_GET['file'], "rw")) !== false) {
            while (($data = fgetcsv($langFile,0,",")) !== false) {
                $langArray[] = array(
                    $data[0],
                    $data[1]
                );
            }
            echo '
        <a href=\'?\'><button>Go back</button> </a>
        <form method="post" action="">
        <table id="editable_table">
            <tr>
                <th>String</th>
                <th>Translation</th>
               </tr>
            <tr>
        ';
            for($i=0;$i<count($langArray);$i++){ //'.$block->getButtonHtml('completeAndRedirect(', $language).'
                echo '
                <td><input class="csv-field" type="text" name="'.$i.'-0" value="'.$langArray[$i][0].'"></td>
                <td><input class="csv-field" type="text" name="'.$i.'-1" value="'.$langArray[$i][1].'"></td>
            </tr>
        ';
            }
            echo '</table>
                    <input type="hidden" name="form_key" value="'.$block->getFormKey().'" />
                    <input type="submit" value="Submit">
                    </form>';
            fclose($langFile);
        }
    }
    else {
        echo '
        <table>
            <tr>
                <th class="post-name">Name</th>
                <th class="post-edit">Content</th>
               </tr>
            <tr>
        ';
        foreach ($languageFiles as $language){ //'.$block->getButtonHtml('completeAndRedirect(', $language).'
            echo '
                <td>'.$language.'</td>
                <td>
                    <a href=\'?file='.$language.'\'><button>Edit</button> </a>
                </td>
            </tr>
        ';
        }
        echo '</table>';
    }
    ?>
</body>
</html>
